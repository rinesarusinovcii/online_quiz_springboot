
CREATE TABLE quizzes
(
    id          BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    title       VARCHAR(50)                             NOT NULL,
    description VARCHAR(1000),
    category    VARCHAR(20)                             NOT NULL,
    created_at  date                                    NOT NULL,
    time_limit  INTEGER                                 NOT NULL,
    user_id     BIGINT,
    CONSTRAINT pk_quizzes PRIMARY KEY (id)
);

CREATE TABLE reports
(
    id            BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    average_score DOUBLE PRECISION                        NOT NULL,
    highest_score DOUBLE PRECISION                        NOT NULL,
    created_at    date                                    NOT NULL,
    CONSTRAINT pk_reports PRIMARY KEY (id)
);

CREATE TABLE results
(
    id              BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    score           DOUBLE PRECISION                        NOT NULL,
    correct_answers INTEGER                                 NOT NULL,
    wrong_answers   INTEGER                                 NOT NULL,
    is_passed       BOOLEAN                                 NOT NULL,
    CONSTRAINT pk_results PRIMARY KEY (id)
);

CREATE TABLE users
(
    id        BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    name      VARCHAR(25)                             NOT NULL,
    surname   VARCHAR(25)                             NOT NULL,
    birthdate date                                    NOT NULL,
    username  VARCHAR(50)                             NOT NULL,
    email     VARCHAR(50)                             NOT NULL,
    password  VARCHAR(255)                            NOT NULL,
    role      VARCHAR(255)                            NOT NULL,
    CONSTRAINT pk_users PRIMARY KEY (id)
);

ALTER TABLE users
    ADD CONSTRAINT uc_users_username UNIQUE (username);

ALTER TABLE question
    ADD CONSTRAINT FK_QUESTION_ON_QUIZ FOREIGN KEY (quiz_id) REFERENCES quizzes (id);

ALTER TABLE quizzes
    ADD CONSTRAINT FK_QUIZZES_ON_USER FOREIGN KEY (user_id) REFERENCES users (id);